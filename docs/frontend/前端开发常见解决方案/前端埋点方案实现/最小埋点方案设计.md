原本代码：

```ts
/**
   * 启动定时上报
   */
private startFlushTimer(): void {
  if (this.timer) return

  this.timer = window.setInterval(() => {
    if (this.queue.length > 0) {
      this.flush()
    }
  }, this.config.flushInterval)
}
```

这是定时上报的代码，采用setInterval实现

但是setInterval会有隐患：

- flush() 执行时间超过 interval，会导致「并发多次上报」
- setInterval 不保证精确执行（被浏览器 throttle）
- 用户离开页面、切换后台会导致 interval 执行停止
- flushInterval 改变时会出现两个 interval 重叠

最推荐方案：使用 setTimeout + 递归调度（更安全）

```ts
private startFlushTimer(): void {
  if (this.timer) return
  this.scheduleNextFlush()
}

private scheduleNextFlush(): void {
  this.timer = window.setTimeout(async () => {
    if (this.queue.length > 0 && !this.isReporting) {
      await this.flush()
    }
    this.scheduleNextFlush() // ★ 再次调度下一次执行
  }, this.config.flushInterval)
}
```

