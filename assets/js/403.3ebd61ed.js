(window.webpackJsonp=window.webpackJsonp||[]).push([[403],{691:function(s,a,n){"use strict";n.r(a);var t=n(8),e=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"ssh密钥生成"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh密钥生成"}},[s._v("#")]),s._v(" ssh密钥生成")]),s._v(" "),a("p",[s._v("https://docs.microsoft.com/zh-cn/azure/virtual-machines/linux/create-ssh-keys-detailed")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("ssh-keygen "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" PEM "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" rsa "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"azureuser@myserver"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" ~/.ssh/mykeys/myprivatekey "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-N")]),s._v(" mypassphrase\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[a("strong",[s._v("命令解释")])]),s._v(" "),a("p",[a("code",[s._v("ssh-keygen")]),s._v(" = 用于创建密钥的程序")]),s._v(" "),a("p",[a("code",[s._v("-m PEM")]),s._v(" = 将密钥的格式设为 PEM")]),s._v(" "),a("p",[a("code",[s._v("-t rsa")]),s._v(" = 要创建的密钥类型，本例中为 RSA 格式")]),s._v(" "),a("p",[a("code",[s._v("-b 4096")]),s._v(" = 密钥的位数，本例中为 4096")]),s._v(" "),a("p",[a("code",[s._v('-C "azureuser@myserver"')]),s._v(" = 追加到公钥文件末尾以便于识别的注释。 通常以电子邮件地址用作注释，但也可以使用任何最适合你基础结构的事物。")]),s._v(" "),a("p",[a("code",[s._v("-f ~/.ssh/mykeys/myprivatekey")]),s._v(" = 私钥文件的文件名（如果选择不使用默认名称）。 追加了 "),a("code",[s._v(".pub")]),s._v(" 的相应公钥文件在相同目录中生成。 该目录必须存在。")]),s._v(" "),a("p",[a("code",[s._v("-N mypassphrase")]),s._v(" = 用于访问私钥文件的其他密码。")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("$ ssh-keygen "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" rsa "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-C")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dongcheng96@foxmail.com"')]),s._v("\nEnter "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" to save the key "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/Users/cheng/.ssh/id_rsa"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": /Users/cheng/.ssh/banwa_id_rsa "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#输入保存路径")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"服务器开启ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器开启ssh"}},[s._v("#")]),s._v(" 服务器开启ssh")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("用"),a("code",[s._v("ssh-keygen")]),s._v("生成密钥的时候,如果本地已经存在id_rsa,id_rsa.pub 文件,可以直接使用.")])]),s._v(" "),a("li",[a("p",[s._v("如果服务器不支持密钥登陆,则需要开启.参考链接:"),a("a",{attrs:{href:"https://hyjk2000.github.io/2012/03/16/how-to-set-up-ssh-keys/",target:"_blank",rel:"noopener noreferrer"}},[s._v("设置SSH通过密钥登陆"),a("OutboundLink")],1)]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/ssh/sshd_config\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改如下内容")]),s._v("\nRSAAuthentication "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\nPubkeyAuthentication "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("完成以上操作后,使用root用户可以正常登陆,但是用普通用户登陆仍然要输入密码")]),s._v(" "),a("p",[a("strong",[s._v("这里的原因是.ssh目录与authorized_keys文件的权限不能太大,像766这种肯定是无法登陆的.")])]),s._v(" "),a("p",[a("strong",[s._v("于是我对照root用户下的权限,改成了700,测试发现可以登陆了")])]),s._v(" "),a("p",[s._v("注意: .ssh目录权限改为700,authorized_keys 权限改为600")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("700")]),s._v(" ~/.ssh\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v(" ~/.ssh/authorized_keys\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])]),s._v(" "),a("h3",{attrs:{id:"在服务器上安装公钥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在服务器上安装公钥"}},[s._v("#")]),s._v(" 在服务器上安装公钥")]),s._v(" "),a("p",[s._v("键入以下命令，在服务器上安装公钥：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" .ssh\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" id_rsa.pub "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" authorized_keys\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"ssh配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh配置"}},[s._v("#")]),s._v(" ssh配置")]),s._v(" "),a("p",[s._v("参考https://www.cyberciti.biz/faq/create-ssh-config-file-on-linux-unix/")]),s._v(" "),a("h4",{attrs:{id:"etc-ssh-sshd-config配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#etc-ssh-sshd-config配置"}},[s._v("#")]),s._v(" /etc/ssh/sshd_config配置")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("PasswordAuthentication no\t#禁用密码登陆\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"etc-ssh-ssd-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#etc-ssh-ssd-config"}},[s._v("#")]),s._v(" /etc/ssh/ssd_config")]),s._v(" "),a("blockquote",[a("p",[s._v("This files set the default configuration for all users of OpenSSH clients on that desktop/laptop and it must be readable by all users on the system.")])]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#\t$OpenBSD: ssh_config,v 1.34 2019/02/04 02:39:42 dtucker Exp $")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This is the ssh client system-wide configuration file.  See")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh_config(5) for more information.  This file provides defaults for")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# users, and the values can be changed in per-user configuration files")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or on the command line.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Configuration data is parsed as follows:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  1. command line options")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  2. user-specific file")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  3. system-wide file")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Any configuration value is only changed the first time it is set.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Thus, host-specific definitions should be at the beginning of the")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# configuration file, and defaults at the end.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Site-wide defaults for some commonly used options.  For a comprehensive")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# list of available options, their meanings and defaults, please see the")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh_config(5) man page.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Host *")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   ForwardAgent no")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   ForwardX11 no")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   PasswordAuthentication yes")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   HostbasedAuthentication no")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   GSSAPIAuthentication no")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   GSSAPIDelegateCredentials no")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   BatchMode no")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   CheckHostIP yes")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   AddressFamily any")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   ConnectTimeout 0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   StrictHostKeyChecking ask")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   IdentityFile ~/.ssh/id_rsa")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   IdentityFile ~/.ssh/id_dsa")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   IdentityFile ~/.ssh/id_ecdsa")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   IdentityFile ~/.ssh/id_ed25519")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   Port 22")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   MACs hmac-md5,hmac-sha1,umac-64@openssh.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   EscapeChar ~")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   Tunnel no")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   TunnelDevice any:any")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   PermitLocalCommand no")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   VisualHostKey no")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   ProxyCommand ssh -q -W %h:%p gateway.example.com")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   RekeyLimit 1G 1h")]),s._v("\n\nHost *\n\tSendEnv "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("LANG")]),s._v(" LC_*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br")])]),a("h4",{attrs:{id:"ssh-config"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ssh-config"}},[s._v("#")]),s._v(" ~/.ssh/config")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("~/.ssh/config")]),s._v(" or "),a("code",[s._v("$HOME/.ssh/config")]),s._v(" : This is user’s own configuration file which, overrides the settings in the global client configuration file, /etc/ssh/ssh_config.")])])])}),[],!1,null,null,null);a.default=e.exports}}]);