(window.webpackJsonp=window.webpackJsonp||[]).push([[230],{519:function(s,t,n){"use strict";n.r(t);var a=n(8),e=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"v-code-diff打包构建失败"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#v-code-diff打包构建失败"}},[s._v("#")]),s._v(" v-code-diff打包构建失败")]),s._v(" "),t("blockquote",[t("p",[s._v('Failed to resolve entry for package "v-code-diff". The package may have incorrect main/module/exports specified in its package.json.')])]),s._v(" "),t("p",[s._v("pnpm 是导致 v-code-diff 打包失败的根本原因。这是 pnpm 7+ 的安全机制（node-linker=hoisted + shamefully-hoist=false 默认行为）与 v-code-diff 包 postinstall 构建脚本依赖 不兼容的典型案例。")]),s._v(" "),t("p",[s._v("v-code-diff 在 package.json 中定义了 postinstall 脚本：")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"scripts"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"postinstall"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node build.js"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 或类似构建入口")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("这个脚本会在 npm install 时自动执行，"),t("strong",[s._v("生成 dist/ 目录和入口文件")]),s._v("（index.js, index.esm.js 等）。")]),s._v(" "),t("p",[s._v("但 "),t("strong",[s._v("pnpm")]),s._v(" 默认：")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("阻止外部脚本自动运行")]),s._v("（安全策略）")]),s._v(" "),t("li",[s._v("使用 "),t("strong",[s._v("严格的依赖隔离")]),s._v("（非 hoisted 模式）")]),s._v(" "),t("li",[s._v("postinstall 脚本被 "),t("strong",[s._v("阻塞")]),s._v(" → dist/ 目录 "),t("strong",[s._v("未生成")])]),s._v(" "),t("li",[s._v("Vite 打包时找不到入口 → Failed to resolve entry")])]),s._v(" "),t("h3",{attrs:{id:"手动运行-postinstall-脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#手动运行-postinstall-脚本"}},[s._v("#")]),s._v(" 手动运行 postinstall 脚本")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. 安装依赖（pnpm）")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 手动执行 v-code-diff 的构建脚本")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("pnpm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--filter")]),s._v(" v-code-diff "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run postinstall\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或直接进入 node_modules 运行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" node_modules/v-code-diff/build.js\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);