(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{446:function(t,s,e){"use strict";e.r(s);var a=e(8),r=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"redux"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redux"}},[t._v("#")]),t._v(" Redux")]),t._v(" "),s("h2",{attrs:{id:"state"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#state"}},[t._v("#")]),t._v(" State")]),t._v(" "),s("p",[s("em",[t._v("State")]),t._v(" (也称为 "),s("em",[t._v("state tree")]),t._v(") 是一个宽泛的概念，但是在 Redux API 中，通常是指一个唯一的 state 值，由 store 管理且由 "),s("a",{attrs:{href:"https://www.redux.org.cn/docs/api/Store.html#getState",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("getState()")]),s("OutboundLink")],1),t._v(" 方法获得。它表示了 Redux 应用的全部状态，通常为一个多层嵌套的对象。")]),t._v(" "),s("p",[t._v("约定俗成，顶层 state 或为一个对象，或像 Map 那样的键-值集合，也可以是任意的数据类型。然而你应尽可能确保 state 可以被序列化，而且不要把什么数据都放进去，导致无法轻松地把 state 转换成 JSON。")]),t._v(" "),s("p",[s("strong",[t._v("如果想要得到某个时间点的数据，就需要对Store生成快照。这种时间点的数据集合，就叫做State。")])]),t._v(" "),s("h4",{attrs:{id:"action"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#action"}},[t._v("#")]),t._v(" Action")]),t._v(" "),s("p",[s("em",[t._v("Action")]),t._v(" 是一个普通对象，用来表示即将改变 state 的意图。它是将数据放入 store 的唯一途径。无论是从 UI 事件、网络回调，还是其他诸如 WebSocket 之类的数据源所获得的数据，最终都会被 dispatch 成 action。")]),t._v(" "),s("h4",{attrs:{id:"reducer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reducer"}},[t._v("#")]),t._v(" Reducer")]),t._v(" "),s("p",[s("em",[t._v("Reducer")]),t._v(" (也称为 "),s("em",[t._v("reducing function")]),t._v(") 函数接受两个参数：之前累积运算的结果(accumulator)和当前被累积的值(currentValue)，返回的是一个新的累积结果。该函数把一个集合归并成一个单值。")]),t._v(" "),s("p",[s("code",[t._v("reducer")]),t._v("有点类似于vuex 中的mutation")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://cn.redux.js.org/introduction/getting-started/#redux-toolkit-%E7%A4%BA%E4%BE%8B",target:"_blank",rel:"noopener noreferrer"}},[t._v("查看redux reducer"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("配合Redux Toolkit 的代码跟vuex很像")]),t._v(" "),s("h3",{attrs:{id:"reducer-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reducer-2"}},[t._v("#")]),t._v(" Reducer")]),t._v(" "),s("h4",{attrs:{id:"combinereducers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#combinereducers"}},[t._v("#")]),t._v(" combineReducers")]),t._v(" "),s("p",[t._v("合并reducer")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("combineReducers")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  visibilityFilter"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  todos\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h4",{attrs:{id:"开启devtool"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开启devtool"}},[t._v("#")]),t._v(" 开启devtool")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" store "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createStore")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  reducer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("__REDUX_DEVTOOLS_EXTENSION__ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("__REDUX_DEVTOOLS_EXTENSION__")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h2",{attrs:{id:"store"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#store"}},[t._v("#")]),t._v(" Store")]),t._v(" "),s("p",[t._v("Store提供了如下方法")]),t._v(" "),s("ul",[s("li",[t._v("维持应用的 state；")]),t._v(" "),s("li",[t._v("提供 "),s("a",{attrs:{href:"https://www.redux.org.cn/docs/api/Store.html#getState",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("getState()")]),s("OutboundLink")],1),t._v(" 方法获取 state；")]),t._v(" "),s("li",[t._v("提供 "),s("a",{attrs:{href:"https://www.redux.org.cn/docs/api/Store.html#dispatch",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("dispatch(action)")]),s("OutboundLink")],1),t._v(" 方法更新 state；")]),t._v(" "),s("li",[t._v("通过 "),s("a",{attrs:{href:"https://www.redux.org.cn/docs/api/Store.html#subscribe",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("subscribe(listener)")]),s("OutboundLink")],1),t._v(" 注册监听器;")]),t._v(" "),s("li",[t._v("通过 "),s("a",{attrs:{href:"https://www.redux.org.cn/docs/api/Store.html#subscribe",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("subscribe(listener)")]),s("OutboundLink")],1),t._v(" 返回的函数注销监听器。")])]),t._v(" "),s("h3",{attrs:{id:"subscribe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#subscribe"}},[t._v("#")]),t._v(" subscribe")]),t._v(" "),s("p",[t._v("每次state更新，都会触发subscribe中的listener")]),t._v(" "),s("p",[t._v("于是以下代码就可以用于触发页面更新。")]),t._v(" "),s("p",[t._v("我们都知道React触发页面更新必须通过state/props的更新来触发render")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("store"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("subscribe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("store"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"connect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect"}},[t._v("#")]),t._v(" connect")]),t._v(" "),s("p",[t._v("通过高阶组件connect来将组件和store关联起来")])])}),[],!1,null,null,null);s.default=r.exports}}]);