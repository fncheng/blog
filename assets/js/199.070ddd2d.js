(window.webpackJsonp=window.webpackJsonp||[]).push([[199],{485:function(s,t,a){"use strict";a.r(t);var e=a(8),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"tree-shaking"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking"}},[s._v("#")]),s._v(" tree-shaking")]),s._v(" "),t("p",[s._v("https://juejin.cn/post/7004297344300777502")]),s._v(" "),t("p",[s._v("Tree-shaking只支持ESM的引入方式，不支持 Common JS 的引入方式。")]),s._v(" "),t("ul",[t("li",[s._v("ESM: export + import")]),s._v(" "),t("li",[s._v("Common JS: module.exports + require")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" add "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lodash'")]),s._v("\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 不支持")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" add "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lodash-es'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 支持")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("原因是lodash是module.exports 导出的")]),s._v(" "),t("img",{staticStyle:{zoom:"70%"},attrs:{src:"/Users/cheng/Library/Application Support/typora-user-images/image-20220810100605663.png",alt:"image-20220810100605663"}}),s._v(" "),t("p",[s._v("使用lodash之前的大小")]),s._v(" "),t("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://minimax-1256590847.cos.ap-shanghai.myqcloud.com/img/image-20231020164837256.png",alt:"image-20231020164837256"}}),s._v(" "),t("p",[s._v("引入lodash并使用后")]),s._v(" "),t("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://minimax-1256590847.cos.ap-shanghai.myqcloud.com/img/image-20231020165449685.png",alt:"image-20231020165449685"}}),s._v(" "),t("p",[s._v("而使用lodash-es后 大小几乎没变")]),s._v(" "),t("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://minimax-1256590847.cos.ap-shanghai.myqcloud.com/img/image-20231020165625226.png",alt:"image-20231020165625226"}}),s._v(" "),t("h3",{attrs:{id:"什么是tree-shaking"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是tree-shaking"}},[s._v("#")]),s._v(" 什么是Tree-shaking")]),s._v(" "),t("p",[s._v("Tree-shaking 是一种用于优化 JavaScript 代码的技术，主要用于移除代码中未被使用的部分，以减小最终打包生成的文件大小。")]),s._v(" "),t("p",[s._v("具体来说，Tree-shaking 的过程是在构建时通过静态分析确定哪些模块、函数和变量没有被实际使用，然后将这些未使用的部分从最终的打包结果中移除，以减小文件体积。")]),s._v(" "),t("p",[s._v("要使 Tree-shaking 生效，有几个前提条件：")]),s._v(" "),t("ol",[t("li",[s._v("使用 ES2015 模块系统：Tree-shaking 主要基于 ES2015 模块的静态结构，因此确保你的代码是使用 "),t("code",[s._v("import")]),s._v(" 和 "),t("code",[s._v("export")]),s._v(" 进行模块化的。")]),s._v(" "),t("li",[s._v("生产环境构建：Tree-shaking 在生产环境下才会生效")]),s._v(" "),t("li",[s._v("静态分析：Tree-shaking 的原理是通过静态分析确定代码中的依赖关系，因此对于动态导入和一些运行时生成的模块，Tree-shaking 的效果可能会受到限制。")])]),s._v(" "),t("p",[s._v("Tree-shaking 的静态分析是通过对代码的抽象语法树（Abstract Syntax Tree，AST）进行分析实现的。AST 是代码在解析阶段被转换为的一种树状结构表示，它反映了代码的语法结构，每个节点代表了代码中的一个语法单元。")]),s._v(" "),t("h3",{attrs:{id:"如何转换成ast"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何转换成ast"}},[s._v("#")]),s._v(" 如何转换成AST")]),s._v(" "),t("p",[s._v("将源代码转换成AST通常需要专门的解析器，以下是一些常用的解析器")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("Esprima")])]),s._v(" "),t("li",[t("strong",[s._v("Babel")])]),s._v(" "),t("li",[t("strong",[s._v("Acorn")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);