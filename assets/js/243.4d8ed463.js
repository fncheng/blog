(window.webpackJsonp=window.webpackJsonp||[]).push([[243],{532:function(a,s,e){"use strict";e.r(s);var t=e(8),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"lerna"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lerna"}},[a._v("#")]),a._v(" Lerna")]),a._v(" "),s("p",[a._v("Lerna初始化")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("lerna init "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("--independent/-i – 使用独立的 版本控制模式。")]),a._v(" "),s("h3",{attrs:{id:"_2022-update"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2022-update"}},[a._v("#")]),a._v(" 2022 Update")]),a._v(" "),s("blockquote",[s("p",[a._v("As pointed out by my great fellow at the comment section, Lerna is now being held by the Nx team and it's not going to > be maintained anymore in a near future.")]),a._v(" "),s("p",[a._v("The best solution nowadays is to use more native approaches for publishing (as NPM/YARN workspaces) or go straight to Nx.")])]),a._v(" "),s("p",[a._v("stackoverflow上说Lerna 现在由 Nx 团队持有，并且在不久的将来将不再维护")]),a._v(" "),s("h4",{attrs:{id:"创建子项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建子项目"}},[a._v("#")]),a._v(" 创建子项目")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("lerna create\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"安装package至workspace"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装package至workspace"}},[a._v("#")]),a._v(" 安装package至workspace")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("lerna "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" react-dom packages/package1 \n// or \nlerna "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" react-dom "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--scope")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("package1\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("为了设置Lerna开启Yarn工作空间，我们需要配置lerna.json。 让我们添加yarn作为我们的npm客户端，并指定我们使用yarn工作空间。")]),a._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// lerna.json")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"packages"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"packages/*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"version"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"independent"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"npmClient"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"yarn"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"useWorkspaces"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("p",[a._v("设置好yarn后就可以运行命令安装包了")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" workspace app "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" react-dom@17.0.2\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 运行命令，即运行packages/app下 package.json中的scripts")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" workspace app run start\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h4",{attrs:{id:"全局安装package"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#全局安装package"}},[a._v("#")]),a._v(" 全局安装package")]),a._v(" "),s("p",[a._v("use -W flag (or --ignore-workspace-root-check)")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" react-error-overlay@6.0.9 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-D")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-W")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"lerna路径alias"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#lerna路径alias"}},[a._v("#")]),a._v(" lerna路径alias")]),a._v(" "),s("h2",{attrs:{id:"遇到的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#遇到的问题"}},[a._v("#")]),a._v(" 遇到的问题")]),a._v(" "),s("p",[a._v("使用lerna创建react子项目后，运行项目")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("yarn")]),a._v(" workspace app run start\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("跑起来的项目热更新后总会出现")]),a._v(" "),s("p",[s("code",[a._v("Uncaught ReferenceError: process is not defined")]),a._v("的错误")]),a._v(" "),s("p",[a._v("查询到"),s("a",{attrs:{href:"https://blog.csdn.net/qq_19689967/article/details/122209465",target:"_blank",rel:"noopener noreferrer"}},[a._v("相似问题"),s("OutboundLink")],1),a._v("后说可能是react-error-overlay的版本问题，")]),a._v(" "),s("p",[a._v("但是我切换react-error-overlay的版本后，该问题仍然存在。")]),a._v(" "),s("p",[a._v("通过页面上一个"),s("a",{attrs:{href:"https://stackoverflow.com/questions/70368760/react-uncaught-referenceerror-process-is-not-defined",target:"_blank",rel:"noopener noreferrer"}},[a._v("链接"),s("OutboundLink")],1),a._v("发现了另一个解决方案，升级react-scripts v5，升级后问题得到解决。")])])}),[],!1,null,null,null);s.default=r.exports}}]);